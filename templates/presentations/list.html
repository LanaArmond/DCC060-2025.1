{% extends "dashboard.html" %}

{% block content %}
<h2>Presentations</h2>

<a href="{{ url_for('presentations.create_presentation_route') }}" class="btn btn-primary">Create New Presentation</a>

<div class="table-container">
    <table class="dashboard-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Date</th>
                <th>Level</th>
                <th>Guest Number</th>
                <th>Amphitheater</th>
                <th>Conductor</th>
                <th>Students</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for p in presentations %}
            <tr>
                <td>{{ p.id }}</td>
                <td>{{ p.title }}</td>
                <td>{{ p.date.strftime("%Y-%m-%d %H:%M") }}</td>
                <td>{{ p.level }}</td>
                <td>{{ p.guest_number }}</td>
                <td>{{ p.amphitheater.dependency.name if p.amphitheater else "N/A" }}</td>
                <td>{{ p.conductor.professor.worker.user.name if p.conductor else "N/A" }}</td>
                <td>
                    {% if p.students %}
                        {{ p.students|map(attribute="user.name")|join(", ") }}
                    {% else %}
                        Nenhum Estudante Registrado
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('presentations.edit_presentation_route', presentation_id=p.id) }}" class="btn btn-sm btn-warning">Edit</a>
                    <form action="{{ url_for('presentations.delete_presentation_route', presentation_id=p.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('Delete this presentation?');">
                        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="9">No presentations found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
